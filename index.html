<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Website ch√≠nh th·ª©c c·ªßa Tr∆∞·ªùng M·∫ßm Non Ng√¥i Sao Xanh, Qu·∫≠n Thanh Kh√™">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QZ372Y4MPE"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-QZ372Y4MPE');
    </script>
    <title>Tr∆∞·ªùng M·∫ßm Non Ng√¥i Sao Xanh</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- N√∫t hamburger v√† overlay cho mobile -->
    <button class="menu-toggle" id="menu-toggle">
        <span></span>
        <span></span>
        <span></span>
    </button>
    <div class="overlay" id="overlay"></div>

    <header>
        <div class="header-container">
            <img src="logo.png" alt="Logo Tr∆∞·ªùng M·∫ßm Non Ng√¥i Sao Xanh" class="logo">
            <div class="header-text">
                <h1>PH∆Ø·ªúNG AN KH√ä - TP ƒê√Ä N·∫¥NG</h1>
                <h2>Tr∆∞·ªùng M·∫ßm Non Ng√¥i Sao Xanh</h2>
                <p>122 Hu·ª≥nh Ng·ªçc Hu·ªá, P. An Kh√™, ƒê√† N·∫µng<br>ƒêi·ªán tho·∫°i: 0236727466 | Email: ngoisaoxanh114@gmail.com<br><a href="https://www.facebook.com/103755418223477?ref=embed_page" target="_blank">Facebook: Tr∆∞·ªùng M·∫ßm Non Ng√¥i Sao Xanh</a></p>
            </div>
        </div>
        <nav class="menu" id="main-menu">
            <a href="#" class="menu-item">Trang ch·ªß</a>
            <a href="lophoc.html" class="menu-item">L·ªõp H·ªçc C·ªßa B√©</a>
            <a href="phuhuynhgopy.html" class="menu-item">G√≥c Ph·ª• Huynh</a>
            <a href="tuyensinh.html" class="menu-item">Tuy·ªÉn Sinh</a>
            <a href="gioithieu.html" class="menu-item">Gi·ªõi thi·ªáu</a>
            <a href="https://www.facebook.com/profile.php?id=100070277383440&sk=photos" class="menu-item">Th∆∞ Vi·ªán ·∫¢nh</a>
        </nav>
    </header>

    <main>
        <aside class="sidebar">
            <div class="notification">
                <h3>Th√¥ng B√°o Cho B√©</h3>
                <ul id="thongBaoBeContent"><li>ƒêang t·∫£i...</li></ul>
            </div>
            <div class="notification">
                <h3>Th√¥ng B√°o Cho Ph·ª• Huynh</h3>
                <ul id="thongBaoPhuHuynhContent"><li>ƒêang t·∫£i...</li></ul>
            </div>
            <div class="notification">
                <h3>Th√¥ng B√°o Chung</h3>
                <p id="thongBaoChungContent">ƒêang t·∫£i...</p>
            </div>
            <div class="notification">
                <h3>ƒê·ªãa Ch·ªâ Tr∆∞·ªùng</h3>
                <div class="map-container" style="height: 300px; width: 100%; margin-bottom: 1rem;">
                    <iframe
                        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3834.0845542939505!2d108.18256191033828!3d16.061101484553024!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x31421906ae508f9d%3A0x35f41e293a4d4335!2zVHLGsOG7nW5nIG3huqdtIG5vbiBOZ8O0aSBTYW8gWGFuaA!5e0!3m2!1svi!2s!4v1742953428105!5m2!1svi!2s"
                        width="100%" height="100%" style="border:0;"
                        allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade">
                    </iframe>
                </div>
            </div>
            <div class="notification statistics">
                <h3>Th·ªëng K√™ Truy C·∫≠p</h3>
                <p>L∆∞·ª£t truy c·∫≠p h√¥m nay: 125</p>
                <p>T·ªïng s·ªë l∆∞·ª£t truy c·∫≠p: 15,342</p>
                <p>Ng∆∞·ªùi ƒëang online: 8</p>
                <p>L∆∞·ª£t truy c·∫≠p tu·∫ßn n√†y: 892</p>
            </div>
        </aside>

        <section class="content">
            <div class="image-slider">
                <button class="slider-button prev">&lt;</button>
                <img src="image1.jpg" alt="H√¨nh ·∫£nh tr∆∞·ªùng m·∫ßm non" class="main-image active">
                <img src="image2.jpg" alt="H√¨nh ·∫£nh tr∆∞·ªùng m·∫ßm non" class="main-image">
                <img src="image3.jpg" alt="H√¨nh ·∫£nh tr∆∞·ªùng m·∫ßm non" class="main-image">
                <img src="image4.jpg" alt="H√¨nh ·∫£nh tr∆∞·ªùng m·∫ßm non" class="main-image">
                <img src="image5.jpg" alt="H√¨nh ·∫£nh tr∆∞·ªùng m·∫ßm non" class="main-image">
                <button class="slider-button next">&gt;</button>
                <div class="slider-dots">
                    <button class="dot active" data-index="0"></button>
                    <button class="dot" data-index="1"></button>
                    <button class="dot" data-index="2"></button>
                    <button class="dot" data-index="3"></button>
                    <button class="dot" data-index="4"></button>
                </div>
            </div>
            <div class="post-titles">
                <h2>C√°c b√†i vi·∫øt c·ªßa tr∆∞·ªùng</h2>
                <div id="posts" class="post-title-container"></div>
                <div id="noPosts" style="text-align:center;color:#666">ƒêang t·∫£i...</div>
            </div>
            <div class="event-section">
                <div class="event-item welcome">
                    <h2 id="welcomeMessage">Ch√†o M·ª´ng Qu√Ω Ph·ª• Huynh ThƒÉm Quan Website<br>Ch√∫c nh·ªØng g√¨ t·ªët ƒë·∫πp nh·∫•t ƒë·∫øn v·ªõi gia ƒë√¨nh</h2>
                </div>
                <div class="event-item event-menu">
                    <a href="menu.html" class="menu-link" id="thucDonLink">ƒêang t·∫£i...</a>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p>B·∫£n quy·ªÅn trang website thu·ªôc v·ªÅ Tr∆∞·ªùng M·∫ßm non Ng√¥i Sao Xanh, 122 Hu·ª≥nh Ng·ªçc Hu·ªá, P. An Kh√™, ƒê√† N·∫µng.</p>
    </footer>

    <script src="script.js"></script>
    <script src="analytics-dashboard.js"></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

    <!-- Script t·∫£i b√†i vi·∫øt v√† n·ªôi dung ƒë·ªông -->
    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyBSZ7-5mr0ll5EP4BHUKC-InnYcu0Th1Tk",
        authDomain: "baivietwebngoisaoxanh.firebaseapp.com",
        projectId: "baivietwebngoisaoxanh",
        appId: "1:38104930715:web:22c85f0b8462e96d47293e"
      };
      firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();

      // --- T·∫£i b√†i vi·∫øt v·ªõi ch·ª©c nƒÉng Ph√¢n trang ---
      const postsEl = document.getElementById('posts');
      const noPostsEl = document.getElementById('noPosts');
      const postsPerPage = 12;
      let currentPage = 1;
      let allPosts = [];

      function renderPostsPage(page) {
          postsEl.innerHTML = '';
          const start = (page - 1) * postsPerPage;
          const end = start + postsPerPage;
          const paginatedPosts = allPosts.slice(start, end);

          paginatedPosts.forEach(post => {
              const d = post.data;
              const art = document.createElement('article');
              art.className = "post-title-item";
              art.innerHTML = `
                <span class="post-date">üëâ Nh·∫•n v√†o ƒë·ªÉ xem</span>
                <a href="post.html?slug=${d.slug}">${d.title || ''}</a>
              `;
              postsEl.appendChild(art);
          });
          renderPaginationControls();
      }

      function renderPaginationControls() {
          const pageCount = Math.ceil(allPosts.length / postsPerPage);
          const oldControls = document.getElementById('pagination-controls');
          if (oldControls) oldControls.remove();
          if (pageCount <= 1) return;

          const controlsContainer = document.createElement('div');
          controlsContainer.id = 'pagination-controls';
          controlsContainer.style.cssText = "text-align: center; margin-top: 25px; margin-bottom: 10px;";

          if (currentPage > 1) {
              const prevButton = document.createElement('button');
              prevButton.textContent = 'Trang tr∆∞·ªõc';
              prevButton.onclick = () => { currentPage--; renderPostsPage(currentPage); };
              prevButton.style.cssText = "margin: 0 5px; padding: 8px 12px; cursor: pointer; border: 1px solid #ccc; background: #f0f0f0; border-radius: 4px;";
              controlsContainer.appendChild(prevButton);
          }

          const pageIndicator = document.createElement('span');
          pageIndicator.textContent = `Trang ${currentPage} / ${pageCount}`;
          pageIndicator.style.margin = '0 10px';
          controlsContainer.appendChild(pageIndicator);

          if (currentPage < pageCount) {
              const nextButton = document.createElement('button');
              nextButton.textContent = 'Trang sau';
              nextButton.onclick = () => { currentPage++; renderPostsPage(currentPage); };
              nextButton.style.cssText = "margin: 0 5px; padding: 8px 12px; cursor: pointer; border: 1px solid #ccc; background: #f0f0f0; border-radius: 4px;";
              controlsContainer.appendChild(nextButton);
          }
          postsEl.parentNode.insertBefore(controlsContainer, postsEl.nextSibling);
      }

      db.collection('posts').orderBy('createdAt', 'desc')
        .onSnapshot(snap => {
          if (snap.empty) {
            noPostsEl.style.display = 'block';
            postsEl.innerHTML = '';
            allPosts = [];
            noPostsEl.textContent = "Ch∆∞a c√≥ b√†i vi·∫øt n√†o.";
            renderPaginationControls();
            return;
          }
          noPostsEl.style.display = 'none';
          allPosts = snap.docs.map(doc => ({ id: doc.id, data: doc.data() }));

          const pageCount = Math.ceil(allPosts.length / postsPerPage);
          if (currentPage > pageCount) currentPage = pageCount || 1;
          
          renderPostsPage(currentPage);
        });

      // --- T·∫£i n·ªôi dung ƒë·ªông cho sidebar v√† th·ª±c ƒë∆°n ---
      const thongBaoBeEl = document.getElementById('thongBaoBeContent');
      const thongBaoPhuHuynhEl = document.getElementById('thongBaoPhuHuynhContent');
      const thongBaoChungEl = document.getElementById('thongBaoChungContent');
      const thucDonLinkEl = document.getElementById('thucDonLink');
      const welcomeMessageEl = document.getElementById('welcomeMessage');

      db.collection('site_content').doc('dynamic_content')
        .onSnapshot(doc => {
          if (doc.exists) {
            const data = doc.data();
            thongBaoBeEl.innerHTML = data.thongBaoBe || 'Ch∆∞a c√≥ th√¥ng b√°o.';
            thongBaoPhuHuynhEl.innerHTML = data.thongBaoPhuHuynh || 'Ch∆∞a c√≥ th√¥ng b√°o.';
            thongBaoChungEl.textContent = data.thongBaoChung || 'Ch∆∞a c√≥ th√¥ng b√°o.';
            thucDonLinkEl.textContent = data.thucDonText || 'Xem th·ª±c ƒë∆°n';
            thucDonLinkEl.href = data.thucDonLink || '#';
            if (data.welcomeMessage) {
              welcomeMessageEl.innerHTML = data.welcomeMessage.replace(/\n/g, '<br>');
            } else {
              welcomeMessageEl.innerHTML = 'Ch√†o M·ª´ng Qu√Ω Ph·ª• Huynh ThƒÉm Quan Website<br>Ch√∫c nh·ªØng g√¨ t·ªët ƒë·∫πp nh·∫•t ƒë·∫øn v·ªõi gia ƒë√¨nh';
            }
          } else {
            console.log("Kh√¥ng t√¨m th·∫•y t√†i li·ªáu c·∫•u h√¨nh!");
          }
        });
    </script>
</body>
</html>